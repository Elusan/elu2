% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/my_plot_kobe_all_management_scenario_sim.R
\name{my_plot_kobe_all_management_scenario_sim}
\alias{my_plot_kobe_all_management_scenario_sim}
\title{Multi-scenario Kobe-style phase plot (B vs F)}
\usage{
my_plot_kobe_all_management_scenario_sim(
  rep,
  logax = FALSE,
  plot.legend = TRUE,
  man.legend = TRUE,
  ext = TRUE,
  rel.axes = FALSE,
  xlim = NULL,
  ylim = NULL,
  labpos = c(1, 1),
  xlabel = NULL,
  stamp = NULL,
  verbose = TRUE,
  CI = 0.95
)
}
\arguments{
\item{rep}{A fitted SPiCT report object (class \code{spictcls}). May include a
\code{rep$man} list created by \code{\link[spict:manage]{spict::manage()}} containing scenario fits to plot.}

\item{logax}{Logical; if \code{TRUE}, both axes are shown on logarithmic scales.
Useful when the dynamic range is large. Defaults to \code{FALSE}.}

\item{plot.legend}{Logical; if \code{TRUE}, draws a small legend label for
\eqn{E(B_\infty)} in the top-right when available (not for sub-annual \code{dtc}).
Defaults to \code{TRUE}.}

\item{man.legend}{Logical; if \code{TRUE}, shows a colour legend for management
scenarios when present. Defaults to \code{TRUE}. (Internally the plot ultimately
hides the legend for a clean Kobe panel; keep \code{TRUE} to ensure consistent
colour mapping in downstream compositions.)}

\item{ext}{Logical; if \code{TRUE} and \code{rel.axes = FALSE}, adds secondary axes
for the relative scales (\eqn{B_t/B_{MSY}}, \eqn{F_t/F_{MSY}}). Defaults to \code{TRUE}.}

\item{rel.axes}{Logical; if \code{TRUE}, the primary axes are the relative scales
\eqn{B_t/B_{MSY}} and \eqn{F_t/F_{MSY}} (forced when time-varying growth is on).
Defaults to \code{FALSE}.}

\item{xlim}{Numeric length-2 vector with x-axis limits. If \code{NULL}, limits are
computed from data, the RP ellipse, and (if available) \eqn{E(B_\infty)}.}

\item{ylim}{Numeric length-2 vector with y-axis limits. If \code{NULL}, limits are
computed from data and the RP ellipse.}

\item{labpos}{Length-2 numeric giving label anchor for first/last time labels.
(Reserved; kept for compatibility.) Default \code{c(1, 1)}.}

\item{xlabel}{Optional x-axis label. If \code{NULL}, a math expression is used:
\code{B[t]} (with catch unit appended) or \code{B[t]/B[MSY]} on relative axes.}

\item{stamp}{Optional small text (e.g., version string) stamped at the
bottom-right margin of the plot. Default \code{NULL}.}

\item{verbose}{Logical; if \code{TRUE}, enables warnings for parameter extraction
fallbacks in helper routines. Default \code{TRUE}.}

\item{CI}{Confidence level in (0, 1) used when constructing parameter
intervals via internal extractors. Default \code{0.95}.}
}
\value{
Invisibly returns the \code{ggplot} object after constructing the Kobe panel
(so it can be added to patchwork layouts, saved, etc.).
}
\description{
Draws a Kobe-style phase plot of biomass on the x-axis and fishing
mortality on the y-axis for a fitted \strong{SPiCT} report object (\code{spictcls}).
The plot shows:
\itemize{
\item the four management quadrants (green/yellow/red rectangles) defined by
\eqn{B_{MSY}} and \eqn{F_{MSY}},
\item the recent historical trajectory \eqn{(B_t, F_t)},
\item optional one-step-ahead prediction and the segment to \eqn{E(B_\infty)},
\item optional management-scenario trajectories (if \code{rep$man} is present),
\item optional MSY points when growth is time-varying and the true point if available.
}

Axes can be drawn either on the absolute scale or on the relative scale
(i.e., \eqn{B_t/B_{MSY}} and \eqn{F_t/F_{MSY}}) when \code{rel.axes = TRUE}.
A secondary axis can be shown for relative values when \code{ext = TRUE} and
\code{rel.axes = FALSE}.
}
\details{
Kobe plot for fitted or managed SPiCT objects (ggplot2)

Internally, the function:
\enumerate{
\item Validates \code{rep} and enforces relative axes when time-varying growth
or log-\code{m} covariates are active.
\item Extracts \eqn{B_{MSY}} and \eqn{F_{MSY}} (final or time-varying),
\eqn{B_t} and \eqn{F_t}, and constructs an RP ellipse if the
\code{ellipse} package is available (falls back gracefully otherwise).
\item Optionally aggregates to annual steps when \code{dtc < 1}.
\item Builds the phase rectangles (green/yellow/red) and overlays:
historical path, one-step prediction, \eqn{E(B_\infty)} segment
(if computable), management scenario paths (with dashed pre-interval
segments and solid post-interval segments), and MSY markers.
\item Styles axes (linear/log10), optionally adds secondary relative axes,
and formats tick labels to emphasise the value 1 on relative scales.
}

Management scenarios (if present in \code{rep$man}) are drawn with a consistent,
repeatable palette and ordered using a canonical scenario name order when possible.
}
\section{Dependencies}{

Requires \strong{ggplot2}. If available, \strong{ellipse} is used to draw the
reference point ellipse; otherwise a simple fallback is used.
}

\examples{
\dontrun{
# Assume `fit` is a fitted SPiCT object (class 'spictcls'):
p <- my_plot_kobe_all_management_scenario(fit)
print(p)

# With management scenarios (after spict::manage()):
# fit$man <- spict::manage(fit, scenarios = c(1,2,3))
my_plot_kobe_all_management_scenario(fit, rel.axes = TRUE)
}

}
\seealso{
\code{\link[spict:manage]{spict::manage()}}, \code{\link[spict:fit.spict]{spict::fit.spict()}}
}
