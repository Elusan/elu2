% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_retro_grid.G4_B_et_F2_Corrected_one_CI.R
\encoding{UTF-8}
\name{plot_retro_grid.G4_B_et_F2_Corrected_one_CI}
\alias{plot_retro_grid.G4_B_et_F2_Corrected_one_CI}
\title{Retrospective diagnostics grid (B, F, B/BMSY, F/FMSY) for multiple SPiCT models}
\usage{
plot_retro_grid.G4_B_et_F2_Corrected_one_CI(
  models,
  scenario_name = "Scenario 1",
  peel_colors = NULL,
  palette = "JABBA",
  width = 20,
  height = 8,
  dpi = 400,
  output_dir = NULL,
  filename = NULL
)
}
\arguments{
\item{models}{A \strong{named} list of fitted SPiCT models with \verb{$retro} already computed.
Names are used as column headers (e.g., \code{"S1P"}, \code{"S1F"}, \code{"S1S"}).}

\item{scenario_name}{Character. Title displayed above the grid. Default: \code{"Scenario 1"}.}

\item{peel_colors}{\code{NULL}, a character vector of colors, or a function that returns a
vector of colors given \code{n} peels (e.g., \code{function(n) scales::hue_pal()(n)}).}

\item{palette}{Character. \code{"JABBA"} for a fixed fallback palette (unless \code{jabba_colors}
is present). If \strong{MetBrewer} is installed, any valid MetBrewer palette name is accepted.
Otherwise a hue palette is used.}

\item{width, height, dpi}{Numeric. Device size and resolution \strong{only used when}
\code{output_dir} is non-\code{NULL}. Defaults: \code{width = 20}, \code{height = 8}, \code{dpi = 400}.}

\item{output_dir}{\code{NULL} or directory path. If non-\code{NULL}, the plot is saved as a PNG
in this directory (created recursively if needed).}

\item{filename}{Optional file name for the PNG. If \code{NULL}, a name is derived from
\code{scenario_name} (non-alphanumerics replaced with \verb{_}).}
}
\value{
A \strong{patchwork} plot object representing the combined grid. If \code{output_dir}
is provided, a PNG file is also written to disk.
}
\description{
Creates a multi-column grid (one column per model) with four panels per model:
biomass \eqn{B_t}, fishing mortality \eqn{F_t}, relative biomass \eqn{B_t/B_{MSY}},
and relative fishing mortality \eqn{F_t/F_{MSY}}. Each panel overlays the baseline
run (\code{"All"}) and all retrospective peels; a 95\% CI ribbon is drawn \strong{only} for the
\code{"All"} run, while all runs (including \code{"All"}) are shown as colored lines. When
available, Mohnâ€™s \eqn{\rho} is annotated in each panel for the corresponding quantity.
}
\details{
\itemize{
\item \strong{Inputs:} \code{models} must be a \strong{named} list of fitted SPiCT objects with a non-empty
\verb{$retro} component (the output of \code{retro()}), where list names become the column headers.
\item \strong{Peel handling:} Peel names are normalized so the first element is \code{"All"}. Peels are
ordered deterministically: \code{"All"}
bPbft42GjmGUuJMCY4n2paXAADjNt5sB-\if{latex}{\eqn{\rightarrow}{->}}
numeric peels in \strong{descending} order
bPbft42GjmGUuJMCY4n2paXAADjNt5sB-\if{latex}{\eqn{\rightarrow}{->}}
any non-numeric peels.
\item \strong{Colors:} \code{peel_colors} may be \code{NULL}, a character vector, or a function returning
a vector of colors given \code{n}. If \code{palette = "JABBA"}, a fixed fallback palette is used
unless \code{jabba_colors} exists. If \strong{MetBrewer} is installed and \code{palette} matches a valid
MetBrewer palette, it is used; otherwise a hue palette from \strong{scales} is used.
\item \strong{Quantities extracted:} \code{get.par(..., exp = TRUE, CI = 0.95)} is called for
\code{logB}, \code{logFnotS}, \code{logBBmsy}, and \code{logFFmsynotS} using indices in \code{inp$indest}.
\item \strong{Theme & layout:} Uses a compact minimal theme (bold axis text, panel border, no grid).
Title/legend spacing is controlled via margins on \code{plot.title} and \code{plot.subtitle}
(space \strong{below} the title and \strong{above/below} the legend). If \strong{ggtext} is available,
title/subtitle are rendered with \code{element_markdown()}.
\item \strong{Legend (Peels):} The legend content is provided by an external helper
\code{make_peel_subtitle(peel_names, peel_colors)} (must exist in the search path) and is
passed to \code{plot_annotation(subtitle = ...)}.
}
}
\section{Dependencies}{

Requires \strong{ggplot2} and \strong{patchwork}. Optionally uses \strong{ggtext} (for markdown
titles/subtitles), \strong{MetBrewer} (palettes), \strong{scales} (fallback palette),
and \strong{spict} for \code{get.par()} if a user-defined \code{get.par} is not found.
}

\examples{
\dontrun{
# Suppose 'mods' is a named list of SPiCT fits with $retro present:
p <- plot_retro_grid.G4_B_et_F2_Corrected_one_CI(
  models = mods,
  scenario_name = "Scenario 1",
  palette = "JABBA"
)
print(p)

# Save to file:
plot_retro_grid.G4_B_et_F2_Corrected_one_CI(
  models = mods,
  scenario_name = "Scenario 1",
  output_dir = "FIG/retro_grids"
)
}

}
\seealso{
spict::retro(), \code{make_peel_subtitle()}, \code{theme_minimal_compact()},
and optionally \code{mohns_rho()}.
}
