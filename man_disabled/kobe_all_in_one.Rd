% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/kobe_all_in_one.R
\encoding{UTF-8}
\name{kobe_all_in_one}
\alias{kobe_all_in_one}
\title{All-in-one Kobe plot (base graphics)}
\usage{
kobe_all_in_one(
  rep,
  logax = FALSE,
  plot.legend = TRUE,
  man.legend = TRUE,
  ext = TRUE,
  rel.axes = FALSE,
  xlim = NULL,
  ylim = NULL,
  labpos = c(1, 1),
  xlabel = NULL,
  stamp = NULL,
  verbose = TRUE,
  CI = 0.95
)
}
\arguments{
\item{rep}{A fitted SPiCT report object of class \code{spictcls}
(the result of \code{fit.spict()}). Must have \code{inp$reportmode == 0}.}

\item{logax}{Logical; if \code{TRUE}, both axes are log-scaled (equivalent to
base-graphics \code{log = "xy"}). Default \code{FALSE}.}

\item{plot.legend}{Logical; show the legend for MSY markers,
\eqn{\mathrm{E}(B_{\infty})}, and/or "True" point if present. Default \code{TRUE}.}

\item{man.legend}{Logical; when management scenarios exist in \code{rep$man},
show their legend. Default \code{TRUE}.}

\item{ext}{Logical; add relative axes (\eqn{B_t/B_{\mathrm{MSY}}} on top,
\eqn{F_t/F_{\mathrm{MSY}}} on right) when \code{rel.axes = FALSE}. Ignored when
\code{rel.axes = TRUE}. Default \code{TRUE}.}

\item{rel.axes}{Logical; plot axes in relative units
\eqn{B_t/B_{\mathrm{MSY}}} vs \eqn{F_t/F_{\mathrm{MSY}}}. Forces \code{ext = FALSE}.
Default \code{FALSE}.}

\item{xlim, ylim}{Numeric length-2 vectors giving x/y limits. If \code{NULL}
(default), limits are computed from the ellipse, time series, and
reference points with safety expansion.}

\item{labpos}{Integer length-2 vector passed to \code{text(pos = ...)} to position
the first and last year labels. Default \code{c(1, 1)}.}

\item{xlabel}{Optional x-axis label (overrides the default). Default \code{NULL}.}

\item{stamp}{Optional character string to stamp in the bottom-right margin.
If \code{NULL}, no extra stamp is drawn (the internal version stamp helper can
be used by passing a string). Default \code{NULL}.}

\item{verbose}{Logical; print notes (e.g., when a management period is
shorter than one year). Default \code{TRUE}.}

\item{CI}{Numeric in \code{(0,1)}; confidence level used when extracting
parameters and constructing intervals (e.g., \code{0.95}). Default \code{0.95}.}
}
\value{
Invisibly returns \code{NULL}. The function is called for its side
effect of drawing a plot on the active device (base graphics).
}
\description{
Draws a Kobe plot of fishing mortality versus biomass using a fitted
\strong{SPiCT} result. The plot shows colored management quadrants, the
MSY reference-point “banana” (from the covariance of \eqn{\log B_{\mathrm{MSY}}}
and \eqn{\log F_{\mathrm{MSY}}}), the biomass–fishing mortality trajectory,
optional management-scenario overlays, and stamped first/last years.
}
\details{
The function expects a fitted object of class \code{spictcls} (from
\code{fit.spict()}) with \code{inp$reportmode == 0} so that all states are reported.
When \code{rel.axes = TRUE}, axes are drawn in relative units
\eqn{B_t/B_{\mathrm{MSY}}} and \eqn{F_t/F_{\mathrm{MSY}}} (and the extra top/right
relative axes are suppressed). If \code{inp$timevaryinggrowth} or
\code{inp$logmcovflag} is \code{TRUE}, relative axes are enforced. When time steps
are sub-annual (\code{min(inp$dtc) < 1}), biomass and fishing mortality time
series are aggregated to annual means for plotting.

The “banana” is produced from the estimated covariance between
\eqn{\log B_{\mathrm{MSY}}} and \eqn{\log F_{\mathrm{MSY}}}. If the
\pkg{ellipse} package is available, a proper ellipse is drawn; otherwise a
fallback marker at (\eqn{B_{\mathrm{MSY}}}, \eqn{F_{\mathrm{MSY}}}) is used.

If management scenarios are present in \code{rep$man}, corresponding
trajectories are overlaid and optionally labeled. Otherwise, a one-step
prediction segment and the equilibrium biomass marker \eqn{\mathrm{E}(B_{\infty})}
are shown.
}
\section{Quadrants and markers}{

The background is divided into the usual Kobe quadrants by
\eqn{B_{\mathrm{MSY}}} and \eqn{F_{\mathrm{MSY}}}:
green (safe: \eqn{B \ge B_{\mathrm{MSY}}} and \eqn{F \le F_{\mathrm{MSY}}}),
yellow (transition), and red (unsafe). Current and previous MSY estimates
(for multiple initializations) are marked with \code{pch = 3}; a “True” point
(if supplied in \code{rep$inp$true}) is drawn with \code{pch = 25}.
}

\section{Dependencies}{

Uses base R graphics. If available, \pkg{ellipse} is used to draw the MSY
covariance ellipse. Utilities from \pkg{utils} are used for version stamping.
}

\examples{
\dontrun{
# Fit a SPiCT model (pseudo-code)
# inp  <- make.spict.input(obsC = ..., timeC = ..., obsI = ..., timeI = ...)
# rep  <- fit.spict(inp)

# Default Kobe plot (absolute axes)
kobe_all_in_one(rep)

# Relative axes (B/Bmsy vs F/Fmsy) with log scaling
kobe_all_in_one(rep, rel.axes = TRUE, logax = TRUE)

# Suppress scenario legend, provide a custom stamp
kobe_all_in_one(rep, man.legend = FALSE, stamp = "MyAnalysis v1.0")
}

}
\seealso{
\code{\link[spict]{fit.spict}}, \code{\link[spict]{plotspict}} for the original
plotting functions and model fitting.
}
\author{
Elhadji Ndiaye & Contributors
}
